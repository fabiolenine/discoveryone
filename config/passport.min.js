var localStrategy=require("passport-local").Strategy,User=require("../modulos/IRUserModel.js");module.exports=function(e){e.serializeUser(function(e,t){t(null,e.id)}),e.deserializeUser(function(e,t){User.findById(e,function(e,r){t(e,r)})}),e.use("local-signup",new localStrategy({usernameField:"email",passwordField:"password",passReqToCallback:!0},function(e,t,r,n){process.nextTick(function(){User.findOne({"local.email":t},function(i,o){if(i)return n(i);if(o)return n(null,!1,e.flash("signupMessage","Cadastrado j√° existente."));var s=new User;s.local.email=t,s.local.password=s.generateHash(r),s.save(function(e){if(e)throw e;return n(null,s)})})})})),e.use("local-login",new localStrategy({usernameField:"email",passwordField:"password",passReqToCallback:!0},function(e,t,r,n){User.findOne({"local.email":t},function(e,t){return e?n(e):t&&t.validPassword(r)?n(null,t):n(null,!1)})}))};